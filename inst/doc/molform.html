<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Handling Molecular Formulae</title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>

<!-- MathJax scripts -->
<script type="text/javascript" src="https://cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML">
</script>


<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<h1>Handling Molecular Formulae</h1>

<h2>Introduction</h2>

<p>The molecular formula is the simplest way to characterize a molecular compound.
It specifies the actual number of atoms of each element contained
in the molecule. A molecular formula is represented by the chemical symbol
of each constituent element. If a molecule contains more than one atom for
a particular element, the quantity is shown as subscript after the chemical
symbol. Otherwise, the number of neutrons (atomic mass) that an atom is
composed can differ. This different type of atoms are known as isotopes. The
number of nuclei is represented as superscripted prefix previous to the chemical
element. Generally it is not added when the isotope that characterizes
the element is the most occurrence in nature, e.g., \(C_4H_{11}O^2D\).</p>

<h2>Parsing a Molecule To a Molecular Formula</h2>

<p>Front a molecule, defined as conjunct of atoms helding together by chemical
bonds, we can simplify it taking only the information about the atoms. The <code>rcdk</code>
package provides a parser to translate molecules to molecular formlulas, the
<code>get.mol2formula</code> function.</p>

<pre><code class="r">library(rcdk)
</code></pre>

<pre><code>## Loading required package: rcdklibs
</code></pre>

<pre><code>## Loading required package: rJava
</code></pre>

<pre><code class="r">sp &lt;- get.smiles.parser()
molecule &lt;- parse.smiles(&#39;N&#39;)[[1]]
convert.implicit.to.explicit(molecule)
formula &lt;- get.mol2formula(molecule,charge=0)
</code></pre>

<p>Note that the above formula object is a <code>CDKFormula-class</code>. This class
contains some attributes that defines a molecular formula. For example,
the mass, the charge, the isotopes, the character representation of the
molecular formula and the <a href="https://cdk.github.io/cdk/2.3/docs/api/org/openscience/cdk/interfaces/IMolecularFormula.html">IMolecularFormula</a> <code>jobjRef</code> object.</p>

<p>The molecular mass, charge and string representation for this formula are given by</p>

<pre><code class="r">formula@mass
</code></pre>

<pre><code>## [1] 17.02655
</code></pre>

<pre><code class="r">formula@charge
</code></pre>

<pre><code>## [1] 0
</code></pre>

<pre><code class="r">formula@string
</code></pre>

<pre><code>## [1] &quot;H3N&quot;
</code></pre>

<p>The isotopes for this formula. It is formed from  three attributes. <code>isoto</code> (the
symbol expression of the isotope), <code>number</code> (number of atoms for this isotope)
and <code>mass</code> (exact mass of this isotope).</p>

<pre><code class="r">formula@isotopes
</code></pre>

<pre><code>##      isoto number mass         
## [1,] &quot;N&quot;   &quot;1&quot;    &quot;14.003074&quot;  
## [2,] &quot;H&quot;   &quot;3&quot;    &quot;1.007825032&quot;
</code></pre>

<p>Depending of the circumstances, you may want to change the charge of the
molecular formula.</p>

<pre><code class="r">formula &lt;- set.charge.formula(formula, charge=1)
</code></pre>

<h2>Initializing a Formula from the Symbol Expression</h2>

<p>Other way to create a <code>cdkFormula</code> is from the symbol expression. Thus,
setting the characters of the elemental formula, the function <code>get.formula</code>
parses it to an object of <code>cdkFormula-class</code>.</p>

<pre><code class="r">formula &lt;- get.formula(&#39;NH4&#39;, charge = 1)
formula
</code></pre>

<pre><code>## cdkFormula:  [H4N]+ , mass =  18.03383 , charge =  1
</code></pre>

<h2>Generating Molecular Formula</h2>

<p>Mass spectrometry is an essential and reliable technique to determine the
molecular mass of compounds. Conversely, one can use the measured mass
to identify the compound via its elemental formula. One of the limitations
of the method is the precision and accuracy of the instrumentation. As
a result, rather than specify exact masses, we specify tolerances or ranges
of possible mass, resulting in multiple candidate formulae for a given mass
window. The <code>generate.formula</code> function returns a list of formulae which have
a given mass (within an error window)</p>

<pre><code class="r">mfSet &lt;- generate.formula(18.03383, window=1,
    elements=list(c(&quot;C&quot;,0,50),c(&quot;H&quot;,0,50),c(&quot;N&quot;,0,50)),
    validation=FALSE)
mfSet
</code></pre>

<pre><code>## [[1]]
## cdkFormula:  H4N , mass =  18.03437 , charge =  0 
## 
## [[2]]
## cdkFormula:  CH6 , mass =  18.04695 , charge =  0 
## 
## [[3]]
## cdkFormula:  H18 , mass =  18.14085 , charge =  0
</code></pre>

<p>It is important to know if an elemental formula is valid. The method <code>isvalid.formula</code>
provides this function. Two constraints can be applied, the
<a href="https://en.wikipedia.org/wiki/Nitrogen_rule">nitrogen rule</a> and the  <a href="http://fiehnlab.ucdavis.edu/projects/seven-golden-rules/ring-double-bonds">RDBE rule</a> (Ring Double Bond Equivalent).</p>

<pre><code class="r">formula &lt;- get.formula(&#39;NH4&#39;, charge = 0)
isvalid.formula(formula,rule=c(&quot;nitrogen&quot;,&quot;RDBE&quot;))
</code></pre>

<pre><code>## [1] FALSE
</code></pre>

<p>We can observe that the ammonium is only valid if it is defined with charge
of +1.</p>

<pre><code class="r">formula &lt;- get.formula(&#39;NH4&#39;, charge = 1)
isvalid.formula(formula,rule=c(&quot;nitrogen&quot;,&quot;RDBE&quot;))
</code></pre>

<pre><code>## [1] TRUE
</code></pre>

<p>The <code>generate.formula</code> method can perform these validation tests during formula generation by setting <code>validation=TRUE</code>. However, this can significantly slow down the process of genersating formulae, especially with larger mass windows. When the default of <code>FALSE</code> is used, nonsensical formulae may be generated, and it&#39;s up to the user to filter them out.</p>

<p>In contrast, the <code>generate.formula.iter</code> method employs the Round Robin formula generation algorithm, which is significantly faster than the default method. In contrast to <code>generate/formula</code>, this method returns an iterator which allows you to process large formula sets without excessive memory usage.</p>

<pre><code class="r">mit &lt;- generate.formula.iter(100, charge=0, window=0.1,
                             elements=list(c(&quot;C&quot;,0,50), c(&quot;H&quot;,0,50), c(&quot;N&quot;,0,50)))
hit &lt;- itertools::ihasNext(mit)
while (itertools::hasNext(hit)) 
    print(iterators::nextElem(hit))
</code></pre>

<pre><code>## [1] &quot;[12]C8[1]H4&quot;
## [1] &quot;[12]C7[1]H2[14]N&quot;
## [1] &quot;[12]C6[14]N2&quot;
## [1] &quot;[12]C4[1]H10[14]N3&quot;
## [1] &quot;[12]C3[1]H8[14]N4&quot;
## [1] &quot;[12]C2[1]H6[14]N5&quot;
## [1] &quot;[12]C[1]H4[14]N6&quot;
## [1] &quot;[1]H2[14]N7&quot;
</code></pre>

<p>Note that by default, this function will not check for validity of the generated formulae.</p>

<h2>Calculating Isotope Pattern</h2>

<p>Due to the measurement errors in medium resolution spectrometry, a given
error window can result in a massive number of candidate formulae. The
isotope pattern of ions obtained experimentally can be compared with the
theoretical ones. The best match is reflected as the most probable elemental
formula. <code>rcdk</code> provides the function <code>get.isotope.pattern</code> which predicts
the theoretical isotope pattern given a formula.</p>

<pre><code class="r">formula &lt;- get.formula(&#39;CHCl3&#39;, charge = 0)
isotopes &lt;- get.isotopes.pattern(formula,minAbund=0.1)
isotopes
</code></pre>

<pre><code>##          mass     abund
## [1,] 117.9144 1.0000000
## [2,] 119.9114 0.9598733
## [3,] 121.9085 0.3071189
</code></pre>

<p>In this example we generate a formula for a possible compound with a charge
(\(z \approx 0\)) containing the standard elements C, H, and Cl. The isotope
pattern can be visually inspected, as shown below.</p>

<pre><code class="r">plot(isotopes, type=&quot;h&quot;, xlab=&quot;m/z&quot;, ylab=&quot;Intensity&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-11"/></p>

</body>

</html>
